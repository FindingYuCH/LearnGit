Magix.tmpl("app/views/demo",'<div class=global-demo> <div class="demo-page demo-overview" data-path="myunion/overview"> <div class=step data-step=1> <div class=center> <h1>\u6211\u4eec\u505a\u4e86\u4e00\u4e9b\u6539\u53d8</h1> <p>\u6211\u4eec\u5bf9\u6dd8\u5b9d\u8054\u76df\u7684LOGO\u3001\u4ea7\u54c1\u548c\u67b6\u6784\u505a\u4e86\u5168\u9762\u7684\u8c03\u6574</p> <p>\u8fd9\u4e9b\u8c03\u6574\u662f\u4e3a\u4e86\u8ba9\u4f60\u6709\u66f4\u597d\u7684\u4f53\u9a8c\uff01</p> <a href="#" class="inform-btn btn btn-orange btn-size28" mx-click=goNext data-spm-click="gostr=/tblm.88.1;locaid=ddc47bcc7">\u4e86\u89e3\u4e00\u4e0b</a> </div> </div> <div class=step data-step=2> <div class=ceiling2></div> <div class=tip2></div> <a class="next2 next-btn" href="#" mx-click=goNext data-spm-click="gostr=/tblm.88.1;locaid=dd2d56ddd"></a> </div> <div class=step data-step=3 data-target=.menu-account> <div class=ceiling3 data-offsetx=-6 data-offsetY=6></div> <div class=tip3 data-offsetX=72 data-offsetY=49></div> <a class="next3 next-btn" href="#" data-offsetX=437 data-offsetY=156 mx-click=goNext data-spm-click="gostr=/tblm.88.1;locaid=daa991978"></a> </div> <div class=step data-step=4> <div class=ceiling4></div> <div class=tip4></div> <a class="next4 next-btn" href="#" mx-click=goNext data-spm-click="gostr=/tblm.88.1;locaid=d338fb19c"></a> </div> <div class=step data-step=5> <div class=left-side></div> <div class=tip5></div> <a class="close close-icon" href="#" mx-click=close data-spm-click="gostr=/tblm.88.1;locaid=d44aa3550"></a> </div> </div> <div class="demo-page demo-promo-items" data-path="promo/self/items/index" data-target=.sub-nav> <div class=left-side data-offsetX=-17 data-offsetY=-16></div> <div class=tip data-offsetX=150 data-offsetY=280></div> <a class="close close-icon" href="#" data-offsetX=500 data-offsetY=290 mx-click=close data-spm-click="gostr=/tblm.88.1;locaid=ddb4aed05"></a> </div> <a class=close-btn href="#" mx-click=close data-spm-click="gostr=/tblm.88.1;locaid=d2916cafd"></a> </div>'),KISSY.add("app/views/demo",function(t,e,a,i){var s=i.all,o="unionpub/",l={"myunion/overview":!1,"promo/self/items/index":!1},d={"promo/self/items":function(){return this.location.get("q")?"promo/self/items?q":"promo/self/items/index"}};return e.extend({init:function(e){var i=this;e.cb(this),i.on("viewed",function(e){t.startsWith(e,"/")&&(e=e.slice(1)),t.log("Viewed page:"+e),l.hasOwnProperty(e)&&(l[e]=!0),a.fetchAll([{name:"demo_insertViewedPage",postParams:{url:o+e}}])})},render:function(){var e=this,i=e.getManaged("initFlag");if(i){var s=e.location.pathname;t.startsWith(s,"/")&&(s=s.slice(1));var r=function n(t){if(l[t]===!0)return!1;if(!l.hasOwnProperty(t)){if("function"==typeof d[t]){var a=d[t].call(e,t);if("string"==typeof a)return s=a,n(a)}return!1}return!0}(s);r&&e.manage(a.fetchAll([{name:"demo_queryViewedPage",urlParams:{url:o+s}}],function(t){var a=t.get("data");a.hasViewed||e.loadDemo(s)}))}else e.manage("initFlag","inited"),e.setViewPagelet({})},loadDemo:function(e){var a=this;t.startsWith(e,"/")&&(e=e.slice(1)),s("body").addClass("demo-position-fixed"),a.show(e).fire("viewed",e)},show:function(e){t.log("show: "+e);var a=this;t.startsWith(e,"/")&&(e=e.slice(1)),s(".global-demo .demo-page").removeClass("selected");var i=s('.global-demo [data-path="'+e+'"]');if(i){var o=i.all(".step");o.length?a.showStep(i,1):a.resolvePosition(i),i.addClass("selected"),s(".global-demo").fadeIn(.5)}return a},close:function(){var t=this;return s(".global-demo").fadeOut(.5),s("body").removeClass("demo-position-fixed"),t},showStep:function(t,e){var a=this;if(e=e-1||0,t){var i=t.all(".step");i.hide();var o=s(i[e]);o.length&&(a.resolvePosition(o),o.fadeIn(.5))}return a},closeStep:function(t,e){var a=this;if(e=e-1||0,t){var i=t.all(".step"),o=s(i[e]);o.length&&o.fadeOut(.5)}return a},resolvePosition:function(e){if(!(!e instanceof i)&&e.length){var a=s(e.attr("data-target"));if(a.length){var o=a.offset().top,l=a.offset().left;t.log("standardTop: "+o),t.log("standardLeft: "+l),e.children().each(function(e){var a=t.trim(e.attr("data-offsetX"))||"0",i=t.trim(e.attr("data-offsetY"))||"0";e.css({position:"absolute",top:o+parseInt(i,10),left:l+parseInt(a,10)})})}}},events:{click:{close:function(t){t.halt();var e=t.view;e.close()},goNext:function(e){e.halt();var a=e.view,i=s("#"+e.currentId),o=i.parent(".demo-page"),l=i.parent(".step"),d=parseInt(l.attr("data-step"),10);t.log("currentStep: "+d),a.closeStep(o,d).showStep(o,++d)},goPrev:function(e){e.halt();var a=e.view,i=s("#"+e.currentId),o=i.parent(".demo-page"),l=i.parent(".step"),d=parseInt(l.attr("data-step"),10);t.log("currentStep: "+d),a.closeStep(o,d).showStep(o,--d)}}}})},{requires:["mxext/view","app/models/modelmanager","node","mxext/mmanager","app/models/model","app/models/basemodel","mxext/model","ajax","app/util/util","app/util/datepicker/datepicker","app/util/dialog/dialog","app/util/format/format","app/util/globaltip/globaltip","app/util/robot/sourceid","app/util/spmlog/spmlog","app/util/mathextend/mathextend","app/util/tooltip/tooltip","app/util/widgetds/widgetds","app/util/rank/rank","app/util/reporttip/reporttip","app/util/vcode/vcode","app/util/pagination/index","app/util/fields/fields","app/util/mouseevent/index","magix/vframe","magix/vom","magix/router","brix/gallery/datepicker/index","brix/gallery/calendar/index","brix/gallery/dialog/index","app/util/spmlog/pathmap"]});